{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}
  <div class="container-fluid">
    <h1 style="margin-bottom: 20px; font-weight: bold; color: #333;">{{ title }}</h1>

    <div class="card shadow-sm" style="padding: 20px; margin-bottom: 24px; border-radius: 8px; background: #f8f9fa;">
      <form method="get">
        <div style="display:flex; flex-wrap:wrap; gap:16px; align-items:flex-end;">
          
          <div style="min-width: 150px;">
            <label style="font-weight: 600; font-size: 0.9rem;">–¢–∞–π–ª–∞–Ω–≥–∏–π–Ω —Ç”©—Ä”©–ª</label><br>
            <select name="report" class="form-control" style="width: 100%; height: 38px; border-radius: 4px; border: 1px solid #ced4da;">
              <option value="devices" {% if request.GET.report == "devices" %}selected{% endif %}>–¢”©—Ö”©”©—Ä”©–º–∂“Ø“Ø–¥</option>
              <option value="movements" {% if request.GET.report == "movements" %}selected{% endif %}>–®–∏–ª–∂–∏–ª—Ç —Ö”©–¥”©–ª–≥”©”©–Ω</option>
            </select>
          </div>

          <div>
            <label style="font-weight: 600; font-size: 0.9rem;">–≠—Ö–ª—ç—Ö –æ–≥–Ω–æ–æ</label><br>
            <input type="date" name="date_from" value="{{ request.GET.date_from }}" class="form-control" style="height: 38px; border-radius: 4px; border: 1px solid #ced4da;">
          </div>

          <div>
            <label style="font-weight: 600; font-size: 0.9rem;">–î—É—É—Å–∞—Ö –æ–≥–Ω–æ–æ</label><br>
            <input type="date" name="date_to" value="{{ request.GET.date_to }}" class="form-control" style="height: 38px; border-radius: 4px; border: 1px solid #ced4da;">
          </div>

          <div style="min-width: 180px;">
            <label style="font-weight: 600; font-size: 0.9rem;">–ë–∞–≥–∞–∂–∏–π–Ω —Ç”©—Ä”©–ª</label><br>
            <select name="kind" class="form-control" style="width: 100%; height: 38px; border-radius: 4px; border: 1px solid #ced4da;">
              <option value="">‚Äî –ë“Ø–≥–¥ ‚Äî</option>
              {% for v, l in KIND_CHOICES %}
                <option value="{{ v }}" {% if request.GET.kind == v %}selected{% endif %}>{{ l }}</option>
              {% endfor %}
            </select>
          </div>

          <div style="min-width: 180px;">
            <label style="font-weight: 600; font-size: 0.9rem;">–ë–∞–π—Ä—à–ª—ã–Ω —Ç”©—Ä”©–ª</label><br>
            <select name="location_type" class="form-control" style="width: 100%; height: 38px; border-radius: 4px; border: 1px solid #ced4da;">
              <option value="">‚Äî –ë“Ø–≥–¥ ‚Äî</option>
              {% for v, l in LOCATION_TYPE_CHOICES %}
                <option value="{{ v }}" {% if request.GET.location_type == v %}selected{% endif %}>{{ l }}</option>
              {% endfor %}
            </select>
          </div>

          <div style="display: flex; gap: 8px;">
            <button type="submit" class="btn btn-primary" style="background-color: #007bff; border: none; padding: 8px 20px; border-radius: 4px; color: white; cursor: pointer;">–®“Ø“Ø—Ö</button>
            <a href="." class="btn btn-secondary" style="background-color: #6c757d; border: none; padding: 8px 20px; border-radius: 4px; color: white; text-decoration: none; display: inline-block;">–¶—ç–≤—ç—Ä–ª—ç—Ö</a>
          </div>
        </div>
      </form>
    </div>

    <div class="card shadow-sm" style="padding: 24px; border-radius: 8px; background: white;">
      {% if series %}
        <h2 style="margin-top:0; font-size: 1.25rem; margin-bottom: 20px; color: #444; border-bottom: 2px solid #eee; padding-bottom: 10px;">
          {% if request.GET.report == "movements" %}–®–∏–ª–∂–∏–ª—Ç —Ö”©–¥”©–ª–≥”©”©–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫{% else %}–ë–∞–≥–∞–∂ —Ç”©—Ö”©”©—Ä”©–º–∂–∏–π–Ω —Ç–æ–æ (—Ç”©—Ä–ª”©”©—Ä){% endif %}
        </h2>
        
        <div class="table-responsive">
          <table class="table table-hover" style="width:100%; border-collapse:collapse;">
            <thead style="background-color: #f1f3f5;">
              <tr>
                <th style="text-align:left; padding: 12px; border-bottom: 2px solid #dee2e6;">–ê–Ω–≥–∏–ª–∞–ª / –¢”©—Ä”©–ª</th>
                <th style="text-align:right; padding: 12px; border-bottom: 2px solid #dee2e6; width: 150px;">–¢–æ–æ —Ö—ç–º–∂—ç—ç</th>
              </tr>
            </thead>
            <tbody>
              {% for row in series %}
                <tr style="border-bottom: 1px solid #eee;">
                  <td style="padding: 12px; font-weight: 500;">{{ row.label }}</td>
                  <td style="padding: 12px; text-align:right; color: #007bff; font-weight: bold;">{{ row.value }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div style="text-align: center; padding: 40px;">
          <p style="opacity:.6; font-size: 1.1rem;">üìä ”®–≥”©–≥–¥”©–ª —Ö–∞—Ä–∞–∞—Ö–∞–Ω –±–∞–π—Ö–≥“Ø–π –±–∞–π–Ω–∞. –®“Ø“Ø–ª—Ç“Ø“Ø—Ä—ç—ç –∞—à–∏–≥–ª–∞–Ω –¥–∞—Ç–∞–≥ —Ö–∞—Ä–Ω–∞ —É—É.</p>
        </div>
      {% endif %}
    </div>
  </div>

  <style>
    .card { border: 1px solid #ddd; }
    .shadow-sm { box-shadow: 0 .125rem .25rem rgba(0,0,0,.075)!important; }
    .form-control:focus { border-color: #80bdff; outline: 0; box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25); }
    .table-hover tbody tr:hover { background-color: #f8f9fa; }
  </style>
{% endblock %}